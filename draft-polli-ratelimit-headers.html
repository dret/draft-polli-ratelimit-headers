<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Rate-Limit headers for HTTP</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Current landscape of rate-limiting headers">
<link href="#rfc.section.1.1.1" rel="Chapter" title="1.1.1 Interoperability issues">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 This proposal">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Goals">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 Throttling requests">
<link href="#rfc.section.3" rel="Chapter" title="3 Header Specifications">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 RateLimit-Limit">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 RateLimit-Remaining">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 RateLimit-Reset">
<link href="#rfc.section.4" rel="Chapter" title="4 Examples">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Unparameterized responses">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Throttling informations in responses">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Throttling window specified via parameter">
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 Missing Remaining informations">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Throttling does not prevent clients from issuing requests">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Information disclosure">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Resource exhaustion and clock skew">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 RateLimit-Limit Header Field Registration">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 RateLimit-Remaining Header Field Registration">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 RateLimit-Reset Header Field Registration">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Change Log">
<link href="#rfc.appendix.B" rel="Chapter" title="B Acknowledgements">
<link href="#rfc.appendix.C" rel="Chapter" title="C FAQ">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.22.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Polli, R." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-polli-ratelimit-headers-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-07-18" />
  <meta name="dct.abstract" content="This document defines the RateLimit-Limit, RateLimit-Remaining, RateLimit-Reset header fields for HTTP, thus allowing the server to publish current request quotas and the client to shape its requests and avoid receiving a 429 Too Many Request response." />
  <meta name="description" content="This document defines the RateLimit-Limit, RateLimit-Remaining, RateLimit-Reset header fields for HTTP, thus allowing the server to publish current request quotas and the client to shape its requests and avoid receiving a 429 Too Many Request response." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">R. Polli</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Team Digitale, Italian Government</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">July 18, 2019</td>
</tr>
<tr>
<td class="left">Expires: January 19, 2020</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Rate-Limit headers for HTTP<br />
  <span class="filename">draft-polli-ratelimit-headers-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines the RateLimit-Limit, RateLimit-Remaining, RateLimit-Reset header fields for HTTP, thus allowing the server to publish current request quotas and the client to shape its requests and avoid receiving a 429 Too Many Request response.</p>
<h1><a>Note to Readers</a></h1>
<p><em>RFC EDITOR: please remove this section before publication</em></p>
<p>Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.</p>
<p>The source code and issues list for this draft can be found at <a href="https://github.com/ioggstream/draft-polli-ratelimit-headers">https://github.com/ioggstream/draft-polli-ratelimit-headers</a>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 19, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Current landscape of rate-limiting headers</a>
</li>
<ul><li>1.1.1.   <a href="#rfc.section.1.1.1">Interoperability issues</a>
</li>
</ul><li>1.2.   <a href="#rfc.section.1.2">This proposal</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Goals</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Notational Conventions</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Throttling requests</a>
</li>
<li>3.   <a href="#rfc.section.3">Header Specifications</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">RateLimit-Limit</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">RateLimit-Remaining</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">RateLimit-Reset</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Examples</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Unparameterized responses</a>
</li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">Throttling informations in responses</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">Throttling window specified via parameter</a>
</li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">Missing Remaining informations</a>
</li>
</ul></ul><li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Throttling does not prevent clients from issuing requests</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Information disclosure</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Resource exhaustion and clock skew</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">RateLimit-Limit Header Field Registration</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">RateLimit-Remaining Header Field Registration</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">RateLimit-Reset Header Field Registration</a>
</li>
</ul><li>7.   <a href="#rfc.references">References</a>
</li>
<ul><li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Change Log</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Acknowledgements</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">FAQ</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The widespreading of HTTP as a distributed computation protocol requires an explicit way of communicating service status and usage quotas.</p>
<p id="rfc.section.1.p.2">This was partially addressed with the <samp>Retry-After</samp> header field defined in <a href="#RFC7231" class="xref">[RFC7231]</a> to be returned in <samp>429 Too Many Requests</samp> or <samp>503 Service Unavailable</samp> responses.</p>
<p id="rfc.section.1.p.3">Still, there is not a standard way to communicate service quotas in a way to prevent 4xx or 5xx responses, so that the client can throttle its requests.</p>
<h2 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#current-landscape-of-rate-limiting-headers" id="current-landscape-of-rate-limiting-headers">Current landscape of rate-limiting headers</a>
</h2>
<p id="rfc.section.1.1.p.1">On the web we can find many different rate-limit headers, usually containing the number of allowed requests in a given time window, and when the window is reset.</p>
<p id="rfc.section.1.1.p.2">The common choice is to return three headers containing:</p>
<p></p>

<ul>
<li>the maximum number of allowed requests in the time window;</li>
<li>the number of remaining requests in the current window;</li>
<li>the time remaining in the current window expressed in seconds or as a timestamp;</li>
</ul>
<p id="rfc.section.1.1.p.4">It is common that those headers are returned by HTTP intermediaries such that API Gateways or Reverse Proxies.</p>
<p id="rfc.section.1.1.p.5">Commonly used header field names are:</p>
<p></p>

<ul>
<li>
<samp>X-RateLimit-Limit</samp>, <samp>X-RateLimit-Remaining</samp>, <samp>X-RateLimit-Reset</samp>;</li>
<li>
<samp>X-Rate-Limit-Limit</samp>, <samp>X-Rate-Limit-Remaining</samp>, <samp>X-Rate-Limit-Reset</samp>.</li>
</ul>
<p id="rfc.section.1.1.p.7">There are variants too, where the window is specified in the header field name, eg:</p>
<p></p>

<ul>
<li>
<samp>x-ratelimit-limit-minute</samp>, <samp>x-ratelimit-limit-hour</samp>, <samp>x-ratelimit-limit-day</samp>
</li>
<li>
<samp>x-ratelimit-remaining-minute</samp>, <samp>x-ratelimit-remaining-hour</samp>, <samp>x-ratelimit-remaining-day</samp>
</li>
</ul>
<h3 id="rfc.section.1.1.1">
<a href="#rfc.section.1.1.1">1.1.1.</a> <a href="#interoperability-issues" id="interoperability-issues">Interoperability issues</a>
</h3>
<p id="rfc.section.1.1.1.p.1">A major interoperability issue in throttling is the lack of standard headers, because:</p>
<p></p>

<ul>
<li>each implementation associates different semantics to the same header field names;</li>
<li>header field names proliferates.</li>
</ul>
<p id="rfc.section.1.1.1.p.3">Client applications interfacing with different servers may thus need to process different headers, or the very same application interface that sits behind different reverse proxies may reply with different throttling headers.</p>
<h2 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#this-proposal" id="this-proposal">This proposal</a>
</h2>
<p id="rfc.section.1.2.p.1">This proposal defines syntax and semantics for the following throttling header fields:</p>
<p></p>

<ul>
<li>
<samp>RateLimit-Limit</samp>: containing the maximum number of allowed requests in the time window;</li>
<li>
<samp>RateLimit-Reset</samp>: containing the time remaining in the current window, specified in seconds or as a timestamp;</li>
<li>
<samp>RateLimit-Remaining</samp>: containing the number of remaining requests in the current window;</li>
</ul>
<p id="rfc.section.1.2.p.3">The behavior of <samp>RateLimit-Reset</samp> is compatible with the one of <samp>Retry-After</samp>.</p>
<p id="rfc.section.1.2.p.4">To mitigate issues related to clock synchronization, the preferred way to specify the <samp>RateLimit-Reset</samp> is using the seconds notation respect to the timestamp one.</p>
<h2 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#goals" id="goals">Goals</a>
</h2>
<p id="rfc.section.1.3.p.1">The goals of this proposal are:</p>
<p></p>

<ol>
<li>Standardizing the names and semantic of rate-limit headers;</li>
<li>Improve resiliency of HTTP infrastructures simplifying the enforcement and the adoption of rate-limit headers;</li>
<li>Simplify API documentation avoiding expliciting rate-limit header fields semantic in documentation.</li>
</ol>
<p id="rfc.section.1.3.p.3">The goals do not include:</p>
<p></p>

<dl>
<dt>Authorization:</dt>
<dd style="margin-left: 8">The rate-limit mechanisms described here are not meant to support authorization or other kinds of access controls. On the other side authorized users could be granted a quota.</dd>
<dt>Definition of a Throttling scope:</dt>
<dd style="margin-left: 8">This specification does not cover the throttling scope, that may be the given resource-target, its parent path or the whole Origin <a href="#RFC6454" class="xref">[RFC6454]</a> section 7.</dd>
<dt>Enforcing specific response status code:</dt>
<dd style="margin-left: 8">This specification does not cover the response status code that may be used in throttled replies.</dd>
</dl>
<h2 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#notational-conventions" id="notational-conventions">Notational Conventions</a>
</h2>
<p id="rfc.section.1.4.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 (<a href="#RFC2119" class="xref">[RFC2119]</a> and <a href="#RFC8174" class="xref">[RFC8174]</a>) when, and only when, they appear in all capitals, as shown here.</p>
<p id="rfc.section.1.4.p.2">This document uses the Augmented BNF defined in <a href="#RFC5234" class="xref">[RFC5234]</a> and updated by <a href="#RFC7405" class="xref">[RFC7405]</a> along with the &#8220;#rule&#8221; extension defined in Section 7 of <a href="#RFC7230" class="xref">[RFC7230]</a>.</p>
<p id="rfc.section.1.4.p.3">The term Origin is to be interpreted as described in <a href="#RFC6454" class="xref">[RFC6454]</a> section 7.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#throttling" id="throttling">Throttling requests</a>
</h1>
<p id="rfc.section.2.p.1">Servers use quota mechanisms to avoid systems overload, to ensure an equitable distribution of computational resources or to enforce other policies - eg monetization.</p>
<p id="rfc.section.2.p.2">A basic quota mechanisms can be implemented defining the number of allowable requests in a given time window, eg. 10 requests per second.</p>
<p id="rfc.section.2.p.3">Quotas may be enforced on different basis (eg. per user, per IP, ..) and at different levels. For example, an user may be allowed to issue:</p>
<p></p>

<ul>
<li>10 requests per second;</li>
<li>limited to 60 request per minute;</li>
<li>limited to 1000 request per hour.</li>
</ul>
<p id="rfc.section.2.p.5">When quota is exceeded, servers usually do not service the request</p>
<p id="rfc.section.2.p.6">Instead, they reply with a <samp>4xx</samp> http status code (eg. 429 or 403) or adopt more aggresive policies like dropping connections.</p>
<p id="rfc.section.2.p.7">Complex throttling policies involving different windows can be poorly implemented by clients.</p>
<p id="rfc.section.2.p.8">This specification provides a standard way to communicate quota informations so that the client avoids running over quota.</p>
<p id="rfc.section.2.p.9">This specification does not cover:</p>
<p></p>

<ul>
<li>the scope of the request throttling, that may be the given request-target, its parent path or the whole Origin;</li>
<li>whether non 2xx responses contribute or not to reach the quota limits.</li>
</ul>
<p id="rfc.section.2.p.11">&#8230;</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#header-specifications" id="header-specifications">Header Specifications</a>
</h1>
<p id="rfc.section.3.p.1">The following headers are defined</p>
<h2 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#ratelimit-limit-header" id="ratelimit-limit-header">RateLimit-Limit</a>
</h2>
<p id="rfc.section.3.1.p.1">The <samp>RateLimit-Limit</samp> response header field indicates the maximum number of requests that the client is allowed to make in the time window, before the server throttles it.</p>
<p id="rfc.section.3.1.p.2">The header value is</p>
<pre>
RateLimit-Limit = "RateLimit-Limit" ":" OWS ratelimit-limit-value
ratelimit-limit-value = rlimit [ ";" "delay" "=" delay-seconds]
rlimit = 1*DIGIT
delay-seconds = 1*DIGIT
</pre>
<p id="rfc.section.3.1.p.3">A <samp>RateLimit-Limit</samp> header MAY contain a <samp>delay-seconds</samp> parameter defining the quota interval.</p>
<p id="rfc.section.3.1.p.4">If <samp>delay-seconds</samp> is not specified, it should be communicated out-of-bound (eg. in the documentation) or inferred by the value of <samp>RateLimit-Reset</samp> at the moment of the reset.</p>
<p id="rfc.section.3.1.p.5">Examples:</p>
<pre>
   RateLimit-Limit: 100
   RateLimit-Limit: 100; delay=10
</pre>
<h2 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#ratelimit-remaining-header" id="ratelimit-remaining-header">RateLimit-Remaining</a>
</h2>
<p id="rfc.section.3.2.p.1">The <samp>RateLimit-Remaining</samp> response header field indicates the number of requests left the client until the quota resets.</p>
<p id="rfc.section.3.2.p.2">The header value is</p>
<pre>
RateLimit-Remaining = "RateLimit-Remaining" ":" OWS ratelimit-remaining-value
ratelimit-remaining-value = rlimit
rlimit = 1*DIGIT
</pre>
<p id="rfc.section.3.2.p.3">Examples:</p>
<pre>
   RateLimit-Remaining: 50
</pre>
<h2 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#ratelimit-reset-header" id="ratelimit-reset-header">RateLimit-Reset</a>
</h2>
<p id="rfc.section.3.3.p.1">The <samp>RateLimit-Reset</samp> response header field indicates either:</p>
<p></p>

<ul>
<li>the number of seconds to the quota resets;</li>
<li>the timestamp when the quota resets.</li>
</ul>
<p id="rfc.section.3.3.p.3">The header value is:</p>
<pre>
RateLimit-Reset = "RateLimit-Reset" ":" OWS ratelimit-remaining-value
ratelimit-remaining-value = Retry-After
</pre>
<p id="rfc.section.3.3.p.4">The value of <samp>Retry-After</samp> is defined in <a href="#RFC7231" class="xref">[RFC7231]</a> appendix D and:</p>
<p></p>

<ul>
<li>it SHOULD be number of seconds to delay after the quota is exhausted;</li>
<li>it CAN be an HTTP-date.</li>
</ul>
<p id="rfc.section.3.3.p.6">The preferred way is to expose the number of seconds to delay to mitigate the risk of clock skew between client and server, and potential issues of thundering herd when too many clients are serviced with the same timestamp.</p>
<p id="rfc.section.3.3.p.7">Examples:</p>
<pre>
   RateLimit-Reset: 50
   RateLimit-Reset: Tue, 15 Nov 1994 08:12:31 GMT

</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#examples" id="examples">Examples</a>
</h1>
<h2 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#unparameterized-responses" id="unparameterized-responses">Unparameterized responses</a>
</h2>
<h3 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#throttling-informations-in-responses" id="throttling-informations-in-responses">Throttling informations in responses</a>
</h3>
<p id="rfc.section.4.1.1.p.1">The client is allowed to make 99 more requests in the next 50 seconds.  Throttling interval is communicated out-of-bound.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 100
  Ratelimit-Remaining: 99
  Ratelimit-Reset: 50

  {"hello": "world"}
</pre>
<h3 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#throttling-window-specified-via-parameter" id="throttling-window-specified-via-parameter">Throttling window specified via parameter</a>
</h3>
<p id="rfc.section.4.1.2.p.1">The client is allowed to make 99 more requests in the next 50 seconds.  Throttling interval is communicated by <samp>delay</samp>, so we know the quota is 100 requests per minute.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 100; delay=60
  Ratelimit-Remaining: 99
  Ratelimit-Reset: 50

  {"hello": "world"}
</pre>
<h3 id="rfc.section.4.1.3">
<a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#missing-remaining-informations" id="missing-remaining-informations">Missing Remaining informations</a>
</h3>
<p id="rfc.section.4.1.3.p.1">The server does not expose <samp>RateLimit-Remaining</samp> informations, but resets the limit counter every second, and always returns the couple <samp>RateLimit-Limit</samp> and <samp>RateLimit-Reset</samp> expliciting that the client should respect 10 request per second.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 10
  Ratelimit-Reset: 1

  {"first": "request"}
</pre>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 10
  Ratelimit-Reset: 1

  {"second": "request"}
</pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<h2 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#throttling-does-not-prevent-clients-from-issuing-requests" id="throttling-does-not-prevent-clients-from-issuing-requests">Throttling does not prevent clients from issuing requests</a>
</h2>
<p id="rfc.section.5.1.p.1">While this specification helps client to avoid going over quota, it does not prevent them to make further requests.</p>
<h2 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#information-disclosure" id="information-disclosure">Information disclosure</a>
</h2>
<p id="rfc.section.5.2.p.1">While this specification does not mandate whether non 2xx requests consume quota, if 401 and 403 responses count on quota a malicious client could get traffic informations of another user probing the endpoints.</p>
<h2 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#resource-exhaustion-and-clock-skew" id="resource-exhaustion-and-clock-skew">Resource exhaustion and clock skew</a>
</h2>
<p id="rfc.section.5.3.p.1">When returning <samp>RateLimit-Reset</samp>, implementors must be aware that many throttled clients may come back at the very moment specified. For example, if the throttling interval is hourly and the retured value is something like</p>
<p><samp>RateLimit-Reset: Tue, 15 Nov 1994 08:00:00 GMT </samp></p>
<p id="rfc.section.5.3.p.3">there&#8217;s a high probability that all clients will show up at <samp>08:00:00</samp>.</p>
<p id="rfc.section.5.3.p.4">This could be mitigated adding some jitter to the header value.</p>
<p id="rfc.section.5.3.p.5">&#8230;</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h2 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#ratelimit-limit-header-field-registration" id="ratelimit-limit-header-field-registration">RateLimit-Limit Header Field Registration</a>
</h2>
<p id="rfc.section.6.1.p.1">This section registers the <samp>RateLimit-Limit</samp> header field in the &#8220;Permanent Message Header Field Names&#8221; registry (<a href="#RFC3864" class="xref">[RFC3864]</a>).</p>
<p id="rfc.section.6.1.p.2">Header field name:  <samp>RateLimit-Limit</samp></p>
<p id="rfc.section.6.1.p.3">Applicable protocol:  http</p>
<p id="rfc.section.6.1.p.4">Status:  standard</p>
<p id="rfc.section.6.1.p.5">Author/Change controller:  IETF</p>
<p id="rfc.section.6.1.p.6">Specification document(s):  <a href="#ratelimit-limit-header" class="xref">Section 3.1</a> of this document</p>
<h2 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#ratelimit-remaining-header-field-registration" id="ratelimit-remaining-header-field-registration">RateLimit-Remaining Header Field Registration</a>
</h2>
<p id="rfc.section.6.2.p.1">This section registers the <samp>RateLimit-Remaining</samp> header field in the &#8220;Permanent Message Header Field Names&#8221; registry (<a href="#RFC3864" class="xref">[RFC3864]</a>).</p>
<p id="rfc.section.6.2.p.2">Header field name:  <samp>RateLimit-Remaining</samp></p>
<p id="rfc.section.6.2.p.3">Applicable protocol:  http</p>
<p id="rfc.section.6.2.p.4">Status:  standard</p>
<p id="rfc.section.6.2.p.5">Author/Change controller:  IETF</p>
<p id="rfc.section.6.2.p.6">Specification document(s):  <a href="#ratelimit-remaining-header" class="xref">Section 3.2</a> of this document</p>
<h2 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#ratelimit-reset-header-field-registration" id="ratelimit-reset-header-field-registration">RateLimit-Reset Header Field Registration</a>
</h2>
<p id="rfc.section.6.3.p.1">This section registers the <samp>RateLimit-Reset</samp> header field in the &#8220;Permanent Message Header Field Names&#8221; registry (<a href="#RFC3864" class="xref">[RFC3864]</a>).</p>
<p id="rfc.section.6.3.p.2">Header field name:  <samp>RateLimit-Reset</samp></p>
<p id="rfc.section.6.3.p.3">Applicable protocol:  http</p>
<p id="rfc.section.6.3.p.4">Status:  standard</p>
<p id="rfc.section.6.3.p.5">Author/Change controller:  IETF</p>
<p id="rfc.section.6.3.p.6">Specification document(s):  <a href="#ratelimit-reset-header" class="xref">Section 3.3</a> of this document</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h2 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1321">[RFC1321]</b></td>
<td class="top">
<a>Rivest, R.</a>, "<a href="https://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>", RFC 1321, DOI 10.17487/RFC1321, April 1992.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3230">[RFC3230]</b></td>
<td class="top">
<a>Mogul, J.</a> and <a>A. Van Hoff</a>, "<a href="https://tools.ietf.org/html/rfc3230">Instance Digests in HTTP</a>", RFC 3230, DOI 10.17487/RFC3230, January 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3864">[RFC3864]</b></td>
<td class="top">
<a>Klyne, G.</a>, <a>Nottingham, M.</a> and <a>J. Mogul</a>, "<a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>", BCP 90, RFC 3864, DOI 10.17487/RFC3864, September 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, DOI 10.17487/RFC4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, DOI 10.17487/RFC5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5789">[RFC5789]</b></td>
<td class="top">
<a>Dusseault, L.</a> and <a>J. Snell</a>, "<a href="https://tools.ietf.org/html/rfc5789">PATCH Method for HTTP</a>", RFC 5789, DOI 10.17487/RFC5789, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5843">[RFC5843]</b></td>
<td class="top">
<a>Bryan, A.</a>, "<a href="https://tools.ietf.org/html/rfc5843">Additional Hash Algorithms for HTTP Instance Digests</a>", RFC 5843, DOI 10.17487/RFC5843, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6454">[RFC6454]</b></td>
<td class="top">
<a>Barth, A.</a>, "<a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>", RFC 6454, DOI 10.17487/RFC6454, December 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6585">[RFC6585]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>R. Fielding</a>, "<a href="https://tools.ietf.org/html/rfc6585">Additional HTTP Status Codes</a>", RFC 6585, DOI 10.17487/RFC6585, April 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7230">[RFC7230]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7231">[RFC7231]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>", RFC 7231, DOI 10.17487/RFC7231, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7233">[RFC7233]</b></td>
<td class="top">
<a>Fielding, R.</a>, <a>Lafon, Y.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7233">Hypertext Transfer Protocol (HTTP/1.1): Range Requests</a>", RFC 7233, DOI 10.17487/RFC7233, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7405">[RFC7405]</b></td>
<td class="top">
<a>Kyzivat, P.</a>, "<a href="https://tools.ietf.org/html/rfc7405">Case-Sensitive String Support in ABNF</a>", RFC 7405, DOI 10.17487/RFC7405, December 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="UNIX">[UNIX]</b></td>
<td class="top">
<a>The Open Group, .</a>, "<a>The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98</a>", February 1997.</td>
</tr>
</tbody></table>
<h2 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, DOI 10.17487/RFC2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5788">[RFC5788]</b></td>
<td class="top">
<a>Melnikov, A.</a> and <a>D. Cridland</a>, "<a href="https://tools.ietf.org/html/rfc5788">IMAP4 Keyword Registry</a>", RFC 5788, DOI 10.17487/RFC5788, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6962">[RFC6962]</b></td>
<td class="top">
<a>Laurie, B.</a>, <a>Langley, A.</a> and <a>E. Kasper</a>, "<a href="https://tools.ietf.org/html/rfc6962">Certificate Transparency</a>", RFC 6962, DOI 10.17487/RFC6962, June 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7396">[RFC7396]</b></td>
<td class="top">
<a>Hoffman, P.</a> and <a>J. Snell</a>, "<a href="https://tools.ietf.org/html/rfc7396">JSON Merge Patch</a>", RFC 7396, DOI 10.17487/RFC7396, October 2014.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<p id="rfc.section.A.p.1">RFC EDITOR PLEASE DELETE THIS SECTION.</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.B.p.1">TBD</p>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> <a href="#faq" id="faq">FAQ</a>
</h1>
<p></p>

<ol>
<li>Why defining standard headers for throttling?  <br><br> To simplify enforcement of throttling policies.</li>
<li>Why using delay-seconds instead of UNIX Timestamp?  <br><br> To align with Retry-After header, which is returned in similar contexts, eg on 429 responses.</li>
<li>Why don&#8217;t pass the trottling scope as a parameter?  <br><br> We could if there&#8217;s an agreement on that ;).</li>
<li>Why don&#8217;t support multiple quota limits?  <br><br> We could, if there&#8217;s an agreement on that ;) eg  <br><br> <samp>RateLimit-Limit: 10; delay=1, 50; delay=60, 1000; delay=3600, 5000; delay=86400 </samp>
</li>
<li>Do we want to tie this spec to RFC 6585?  <br><br> <a href="#RFC6585" class="xref">[RFC6585]</a> defines the <samp>429</samp> status code. We could dis-entangle this spec from that one and avoing any suggestion on how to manage over-quota request.</li>
<li>Why not support multiple quota remaining?  <br><br> While this might be of some value, my experience suggests that overly-complex quota implementations results in lower effectiveness of this policy. This spec allows the client to easily focusing on RateLimit-Remaining and RateLimit-Reset.</li>
<li>Can I use RateLimit-* in throttled responses? Yes, you can.</li>
</ol>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Roberto Polli</span> 
	  <span class="n hidden">
		<span class="family-name">Polli</span>
	  </span>
	</span>
	<span class="org vcardline">Team Digitale, Italian Government</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:robipolli@gmail.com">robipolli@gmail.com</a></span>

  </address>
</div>

</body>
</html>

